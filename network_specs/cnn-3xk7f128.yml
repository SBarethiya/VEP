network:
  - layer_func: ~tf.expand_dims
    arguments:
      input: ~layers[-1]
      axis: -1

  - layer_func: ~tf.layers.conv2d
    arguments:
      name: conv1
      inputs: ~layers[-1]
      filters: 128
      kernel_size: [7, '~layers[-1].shape[2]'] 
      strides: [1, 1]
      padding: valid
      activation: ~tf.nn.leaky_relu

  - layer_func: ~tf.layers.conv2d
    arguments:
      name: conv2
      inputs: ~layers[-1]
      filters: 128
      kernel_size: [ 7, '~layers[-1].shape[2]' ]
      strides: [ 1, 1 ]
      padding: valid
      activation: ~tf.nn.leaky_relu

  - layer_func: ~tf.layers.conv2d
    arguments:
      name: conv3
      inputs: ~layers[-1]
      filters: 128
      kernel_size: [ 7, '~layers[-1].shape[2]' ]
      strides: [ 1, 1 ]
      padding: valid
      activation: ~tf.nn.leaky_relu

  - layer_func: ~tf.layers.flatten
    arguments:
      inputs: ~layers[-1]

  - layer_func: ~tf.layers.dense
    arguments:
      name: dense1
      inputs: ~layers[-1]
      units: 100
      activation: ~tf.nn.leaky_relu

  - layer_func: ~tf.layers.dropout
    arguments:
      inputs: ~layers[-1]
      rate: 0.2
      training: ~ph_inputs_dict["training"]
